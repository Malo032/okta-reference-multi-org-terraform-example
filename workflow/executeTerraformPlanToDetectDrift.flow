{"type":"flopack","version":"1.3.0","created":"2022-03-30T14:54:20.022Z","flags":{"auto-transform":true,"looseBooleans":true,"looseStrings":true,"looseNulls":true},"data":{"flos":{"e4609b44-d36c-498f-a007-d55b89a9f990":{"id":"e4609b44-d36c-498f-a007-d55b89a9f990","name":"Execute Terraform Plan to Detect Drift","description":"Executes a Terraform Cloud plan without applying it to determine whether there are changes.  If there are changes, this indicates drift and the appropriate parties should be notified to review.","data":{"id":null,"uuid":"e4609b44-d36c-498f-a007-d55b89a9f990","display":{"preview":[{"module":"control","name":"callable","kernel":true},{"module":"httpfunctions","name":"post","kernel":false},{"module":"control","name":"throwIf","kernel":true},{"module":"control","name":"wait","kernel":true},{"module":"httpfunctions","name":"get","kernel":false},{"module":"string","name":"compose","kernel":true},{"module":"control","name":"continueIf","kernel":true},{"module":"control","name":"continueIf","kernel":true},{"module":"string","name":"compose","kernel":true},{"module":"string","name":"compose","kernel":true},{"module":"slack","name":"sendMessageToChannel2","kernel":false},{"module":"httpfunctions","name":"","kernel":true},{"module":"httpfunctions","name":"","kernel":true}],"isCallable":true},"tree":{"id":2,"name":"empty","description":"This flow has been build w/o a tree and uses the newer, async, Addressing module."},"methods":[{"joins":{},"address":"root:kernel:control:0.0.1:callable","parents":{"version":{"address":"root:kernel:control:0.0.1","key":"0.0.1","data":{"name":"0.0.1"}},"channel":{"address":"root:kernel:control","key":"control","data":{"name":"control"}}},"uuid":"skB2fHeGQ","branches":{},"node":{"key":"callable","data":{"name":"Scheduled Flow"},"model":{"type":"method","_v":2,"key":"callable","executable":false,"displayed":true,"async":false,"cooperative":false,"mirrored":true,"inlined":false,"dependencies":[],"timeout":30000,"idempotent":false,"monitor":false,"webhook":false,"webhookList":false,"webhookConditions":false,"mobile":false,"hooks":{},"policy":{"error":{"type":"finish"}},"metadata":{"id":null,"name":"Scheduled Flow","description":"Start a Flow that executes on-demand, i.e. called by another Flow or via the Invoke API."},"meta":{},"config":null,"partnerChannelKeys":null,"inputs":{"extensible":true,"rules":{"*":{"types":["*"],"collection":"*"}},"groupRules":{"body":{"type":"object","reserved":{},"extensible":true},"headers":{"type":"object","reserved":{"Content-Type":"string"},"extensible":true},"query":{"type":"object","reserved":{},"extensible":true}},"data":{"UAwwnBppX9":{"id":"UAwwnBppX9","group":"context","key":"execution_time","value":{"error":false,"type":"string","collection":false,"data":null,"available":[]},"ref":false,"metadata":{"displayname":"Current Time ","index":0},"required":false,"flags":"d"},"UNFU3jnBjO":{"id":"UNFU3jnBjO","group":"context","key":"execution_id","value":{"error":false,"type":"string","collection":false,"data":null,"available":[]},"ref":false,"metadata":{"displayname":"Execution ID","index":1},"required":false,"flags":"d"}}},"outputs":{"extensible":true,"rules":{"*":{"types":["*"],"collection":"*"}},"data":{"zRAUe-dLiY":{"id":"zRAUe-dLiY","group":"context","key":"execution_time","value":{"error":false,"type":"string","collection":false,"data":null,"available":[]},"ref":false,"metadata":{"displayname":"Current Time ","index":0}},"1vrqukqzGm":{"id":"1vrqukqzGm","group":"context","key":"execution_id","value":{"error":false,"type":"string","collection":false,"data":null,"available":[]},"ref":false,"metadata":{"displayname":"Execution ID","index":1}}},"groupRules":{"context":{"extensible":false},"null":{"extensible":false}}},"runtime":{}}},"pins":{}},{"joins":{},"address":"root:channels:http:httpfunctions:1.0.13:post","parents":{"version":{"address":"root:channels:http:httpfunctions:1.0.13","key":"1.0.13","data":{"name":"1.0.13","id":714}},"channel":{"address":"root:channels:http:httpfunctions","key":"httpfunctions","data":{"name":"httpfunctions","id":72}}},"uuid":"JszvgLOn4","branches":{},"node":{"key":"post","data":{"name":"Start a Run"},"model":{"type":"method","_v":2,"key":"post","executable":true,"displayed":true,"async":true,"cooperative":false,"mirrored":false,"compat":false,"inlined":false,"dependencies":[],"timeout":30000,"idempotent":false,"monitor":false,"webhook":false,"webhookList":false,"webhookConditions":false,"mobile":false,"hooks":{},"policy":{"error":{"type":"finish"}},"metadata":{"id":32595,"name":"Start a Run","description":null},"meta":{},"config":"2756f226-1bc4-4e93-8ab2-957e510fd377","partnerChannelKeys":226,"inputs":{"extensible":false,"rules":{},"groupRules":{"Request":{"extensible":false,"reserved":{},"index":0,"type":"object"}},"data":{"_OXDaVEjRr":{"id":"_OXDaVEjRr","group":"Request","key":"URL","value":{"error":false,"proxy":false,"check":false,"type":"string","collection":false,"data":"https://app.terraform.io/api/v2/runs","available":["string"]},"required":false,"ref":false,"metadata":{"index":0,"optional":false},"flags":"d"},"sh1-NSxVWf":{"id":"sh1-NSxVWf","group":"Request","key":"Query","value":{"error":false,"proxy":false,"check":false,"type":"object","collection":false,"data":{},"available":["string","object"]},"required":false,"ref":false,"metadata":{"index":1,"optional":false},"flags":"d"},"5kkG0dWVE1":{"id":"5kkG0dWVE1","group":"Request","key":"Headers","value":{"error":false,"proxy":false,"check":false,"type":"object","collection":false,"data":{"Content-Type":"application/vnd.api+json"},"available":["object"]},"required":false,"ref":false,"metadata":{"index":2,"optional":false},"flags":"d"},"e6WnWGiUj4":{"id":"e6WnWGiUj4","group":"Request","key":"Body","value":{"error":false,"proxy":false,"check":false,"type":"string","collection":false,"data":"","available":["string","object","Array"]},"required":false,"ref":false,"metadata":{"index":3,"optional":false},"flags":"d"}}},"outputs":{"extensible":false,"rules":{},"groupRules":{"Response":{"extensible":false,"reserved":{},"index":0,"type":"object"}},"data":{"u5OOVuRwzy":{"id":"u5OOVuRwzy","group":"Response","key":"Status Code","value":{"error":false,"type":"number","collection":false,"data":0,"available":["number"]},"ref":false,"metadata":{"index":0},"_used":true},"3BSzEEu0Pp":{"id":"3BSzEEu0Pp","group":"Response","key":"Headers","value":{"error":false,"type":"object","collection":false,"data":{},"available":["object"]},"ref":false,"metadata":{"index":1}},"IkbAPIy_0H":{"id":"IkbAPIy_0H","group":"Response","key":"Body","value":{"error":false,"type":{"data":{"type":{"id":{"type":"string","collection":false},"relationships":{"type":{"plan":{"type":{"links":{"type":{"related":{"type":"string","collection":false}},"collection":false}},"collection":false}},"collection":false},"attributes":{"type":{"message":{"type":"string","collection":false}},"collection":false}},"collection":false}},"collection":false,"data":{},"available":["object"]},"ref":false,"metadata":{"index":2,"collapsed":false},"_used":true}}},"runtime":{},"display":{},"comments":"Perform an HTTP POST request, returning the result of this request and the response headers.\n\nBegins execution of a run in Terraform Cloud - will return 201 Created if successful in starting.","enableNewMetadata":true}},"pins":{"u5OOVuRwzy":{"Uz2TRfdlA":[{"input":"CGGipIFdZH","transform":null}]},"IkbAPIy_0H":{"GlNibMMJuZ":[{"input":"SPW4DXlCh-","transform":null}]}}},{"joins":{},"address":"root:kernel:control:0.0.1:throwIf","parents":{"version":{"address":"root:kernel:control:0.0.1","key":"0.0.1","data":{"name":"0.0.1"}},"channel":{"address":"root:kernel:control","key":"control","data":{"name":"control"}}},"uuid":"Uz2TRfdlA","branches":{},"node":{"key":"throwIf","data":{"name":"Return Error If Run Not Started"},"model":{"type":"method","_v":2,"key":"throwIf","executable":false,"displayed":true,"async":false,"cooperative":false,"mirrored":false,"inlined":false,"dependencies":[],"timeout":90000,"idempotent":false,"monitor":false,"webhook":false,"webhookList":false,"webhookConditions":false,"mobile":false,"hooks":{},"policy":{"error":{"type":"finish"}},"metadata":{"id":null,"name":"Return Error If Run Not Started","description":"If a condition is true, throw an error and end the Flow."},"meta":{},"config":null,"partnerChannelKeys":null,"inputs":{"extensible":true,"rules":{"left-operand":{"types":["object","string","number","Date","boolean"]},"operator":{"types":["string"]},"right-operand":{"types":["object","string","number","Date","boolean"]},"*":{"types":["*"],"collection":"*"}},"data":{"CGGipIFdZH":{"id":"CGGipIFdZH","group":null,"key":"left-operand","value":{"type":"number","collection":false,"data":0,"available":["object","string","number","Date","boolean"],"error":false},"required":false,"ref":false,"metadata":{"index":0,"displayname":"value a"},"flags":"d"},"A0RFAjnj90":{"id":"A0RFAjnj90","group":null,"key":"operator","value":{"type":"string","collection":false,"data":"!=","available":[],"error":false},"required":false,"ref":false,"metadata":{"index":1,"choices":[{"value":"==","label":"equal to"},{"value":"!=","label":"not equal"},{"value":">=","label":"greater than or equal"},{"value":"<=","label":"less than or equal"},{"value":">","label":"greater than"},{"value":"<","label":"less than"},{"value":"%","label":"a multiple of"},{"value":"in","label":"in"},{"value":"not in","label":"not in"},{"value":"has","label":"has key"},{"value":"doesn't have","label":"doesn't have key"},{"value":"is empty","label":"is empty"},{"value":"is not empty","label":"is not empty"}],"displayname":"comparison"},"flags":"d"},"6U01JAR4kn":{"id":"6U01JAR4kn","group":null,"key":"right-operand","value":{"type":"number","collection":false,"data":201,"available":["object","string","number","Date","boolean"],"error":false},"required":false,"ref":false,"metadata":{"index":2,"displayname":"value b"},"flags":"d"},"Ghbgs2zvNh":{"id":"Ghbgs2zvNh","group":null,"key":"message","value":{"type":"string","collection":false,"data":null,"available":["*"]},"required":false,"ref":false,"metadata":{"index":3},"flags":"d"},"PTD1KoXruM":{"id":"PTD1KoXruM","group":null,"key":"statusCode","value":{"type":"number","collection":false,"data":null},"required":false,"ref":false,"metadata":{"index":4},"flags":"d"}}},"outputs":{"extensible":false,"data":{}},"runtime":{},"display":{},"comments":"A request to start a new run on a workspace should return a 201 Created.  If it does not, then error out and end this flow. \n\nThis can happen if there is a run that has been planned but has not been applied or discarded."}},"pins":{}},{"joins":{},"address":"root:kernel:control:0.0.1:wait","parents":{"version":{"address":"root:kernel:control:0.0.1","key":"0.0.1","data":{"name":"0.0.1"}},"channel":{"address":"root:kernel:control","key":"control","data":{"name":"control"}}},"uuid":"MXHReK3Fe","branches":{},"node":{"key":"wait","data":{"name":"Wait For"},"model":{"type":"method","_v":2,"key":"wait","executable":false,"displayed":true,"async":true,"cooperative":false,"mirrored":false,"inlined":false,"dependencies":[],"timeout":90000,"idempotent":false,"monitor":false,"webhook":false,"webhookList":false,"webhookConditions":false,"mobile":false,"hooks":{},"policy":{"error":{"type":"finish"}},"metadata":{"id":null,"name":"Wait For","description":"Pause the Flow and wait for the specified period of time before continuing."},"meta":{},"config":null,"partnerChannelKeys":null,"inputs":{"extensible":false,"data":{"L7sjniUcII":{"id":"L7sjniUcII","group":null,"key":"delay","value":{"type":"number","collection":false,"data":1,"available":[],"error":false},"required":true,"ref":false,"metadata":{"index":0},"flags":"d"},"VnUBTlWzkc":{"id":"VnUBTlWzkc","group":null,"key":"unit","value":{"type":"string","collection":false,"data":"minute","available":[],"error":false},"required":true,"ref":false,"metadata":{"choices":["second","minute","hour","day","week","month","year"],"index":1},"flags":"d"}}},"outputs":{"extensible":false,"data":{}},"runtime":{},"comments":"A run can take time to complete - the run must be marked as finished before we can continue.  For simplicity, we set this timeout card to give the run enough time to complete.\n\nSet it to a suitable time (5 minutes) to allow the plan to finish."}},"pins":{}},{"joins":{},"address":"root:channels:http:httpfunctions:1.0.13:get","parents":{"version":{"address":"root:channels:http:httpfunctions:1.0.13","key":"1.0.13","data":{"name":"1.0.13","id":714}},"channel":{"address":"root:channels:http:httpfunctions","key":"httpfunctions","data":{"name":"httpfunctions","id":72}}},"uuid":"_G_4uwI21","branches":{},"node":{"key":"get","data":{"name":"Get Run Result"},"model":{"type":"method","_v":2,"key":"get","executable":true,"displayed":true,"async":true,"cooperative":false,"mirrored":false,"compat":false,"inlined":false,"dependencies":[],"timeout":30000,"idempotent":false,"monitor":false,"webhook":false,"webhookList":false,"webhookConditions":false,"mobile":false,"hooks":{},"policy":{"error":{"type":"finish"}},"metadata":{"id":32594,"name":"Get Run Result","description":null},"meta":{},"config":"2756f226-1bc4-4e93-8ab2-957e510fd377","partnerChannelKeys":226,"inputs":{"extensible":false,"rules":{},"groupRules":{"Request":{"extensible":false,"reserved":{},"index":0,"type":"object"}},"data":{"-OksPFYQL":{"id":"-OksPFYQL","group":"Request","key":"URL","value":{"error":false,"proxy":false,"check":false,"type":"string","collection":false,"data":"","available":["string"]},"required":false,"ref":false,"metadata":{"index":0,"optional":false},"flags":"d"},"2HgmWxZZ9X":{"id":"2HgmWxZZ9X","group":"Request","key":"Query","value":{"error":false,"proxy":false,"check":false,"type":"object","collection":false,"data":{},"available":["string","object"]},"required":false,"ref":false,"metadata":{"index":1,"optional":false},"flags":"d"},"SqBhzJXU_j":{"id":"SqBhzJXU_j","group":"Request","key":"Headers","value":{"error":false,"proxy":false,"check":false,"type":"object","collection":false,"data":{"Content-Type":"application/vnd.api+json"},"available":["object"]},"required":false,"ref":false,"metadata":{"index":2,"optional":false},"flags":"d"}}},"outputs":{"extensible":false,"rules":{},"groupRules":{"Response":{"extensible":false,"reserved":{},"index":0,"type":"object"}},"data":{"tSPIPq-hgo":{"id":"tSPIPq-hgo","group":"Response","key":"Status Code","value":{"error":false,"type":"number","collection":false,"data":0,"available":["number"]},"ref":false,"metadata":{"index":0}},"v46FWSn-BL":{"id":"v46FWSn-BL","group":"Response","key":"Headers","value":{"error":false,"type":"object","collection":false,"data":{},"available":["object"]},"ref":false,"metadata":{"index":1}},"8ZIE0APaU8":{"id":"8ZIE0APaU8","group":"Response","key":"Body","value":{"error":false,"type":{"data":{"type":{"attributes":{"type":{"status":{"type":"string","collection":false},"has-changes":{"type":"boolean","collection":false},"log-read-url":{"type":"string","collection":false}},"collection":false}},"collection":false}},"collection":false,"data":{},"available":["object"]},"ref":false,"metadata":{"index":2},"_used":true}}},"runtime":{},"display":{},"comments":"Perform an HTTP GET request, returning the result of this request and the response headers.\n\nWe get the result of the run to determine whether the run has completed and whether there are any changes indicated.  If so, we need to alert.","enableNewMetadata":true}},"pins":{"8ZIE0APaU8":{"55gNUjSa9R2":[{"input":"_4fqLTGp8_c","transform":null}]}}},{"joins":{},"address":"root:kernel:string:0.0.1:compose","parents":{"version":{"address":"root:kernel:string:0.0.1","key":"0.0.1","data":{"name":"0.0.1"}},"channel":{"address":"root:kernel:string","key":"string","data":{"name":"string"}}},"uuid":"LjnFRNrnO","branches":{},"node":{"key":"compose","data":{"name":"Compose URL"},"model":{"type":"method","_v":2,"key":"compose","executable":false,"displayed":true,"async":false,"cooperative":false,"mirrored":false,"inlined":false,"dependencies":[],"timeout":90000,"idempotent":false,"monitor":false,"webhook":false,"webhookList":false,"webhookConditions":false,"mobile":false,"hooks":{},"policy":{"error":{"type":"finish"}},"metadata":{"id":null,"name":"Compose URL","description":"Enter free form text and optionally drag fields into your text like a mail merge."},"meta":{},"config":null,"partnerChannelKeys":null,"inputs":{"extensible":true,"rules":{"*":{"types":["string"],"collection":false}},"data":{"pAhjCwEhsO":{"id":"pAhjCwEhsO","group":null,"key":"_text_","value":{"type":"string","collection":false,"data":"https://app.terraform.io{{{_7mqzuVYi}}}","available":[],"error":false},"required":true,"ref":false,"metadata":{"index":0},"flags":"d"},"P58KwM6hiP":{"id":"P58KwM6hiP","group":null,"key":"_7mqzuVYi","value":{"error":false,"proxy":false,"check":false,"type":"string","collection":false,"data":"","available":["string"]},"required":false,"ref":false,"metadata":{"index":1},"flags":"d"}}},"outputs":{"extensible":false,"data":{"agZQDM73lh":{"id":"agZQDM73lh","group":null,"key":"output","value":{"type":"string","collection":false,"data":""},"ref":false,"metadata":{"index":0},"_used":true}}},"runtime":{},"comments":"We need to make a call to the Terraform Cloud API for the specific run.  We retrieve the run ID from the return of the previous API call and combine it with the Terraform Cloud base URL."}},"pins":{"agZQDM73lh":{"_G_4uwI21":[{"input":"-OksPFYQL","transform":null}]}}},{"joins":{},"address":"root:kernel:control:0.0.1:continueIf","parents":{"version":{"address":"root:kernel:control:0.0.1","key":"0.0.1","data":{"name":"0.0.1"}},"channel":{"address":"root:kernel:control","key":"control","data":{"name":"control"}}},"uuid":"NtXJexVD6","branches":{},"node":{"key":"continueIf","data":{"name":"Continue If (Status == \"finished\")"},"model":{"type":"method","_v":2,"key":"continueIf","executable":false,"displayed":true,"async":false,"cooperative":false,"mirrored":false,"inlined":false,"dependencies":[],"timeout":90000,"idempotent":false,"monitor":false,"webhook":false,"webhookList":false,"webhookConditions":false,"mobile":false,"hooks":{},"policy":{"error":{"type":"finish"}},"metadata":{"id":null,"name":"Continue If (Status == \"finished\")","description":"Stop the Flow if a condition isn't true."},"meta":{},"config":null,"partnerChannelKeys":null,"inputs":{"extensible":false,"rules":{"left-operand":{"types":["object","string","number","Date","boolean"]},"right-operand":{"types":["object","string","number","Date","boolean"]}},"data":{"mABEYgvDHd":{"id":"mABEYgvDHd","group":null,"key":"left-operand","value":{"type":"string","collection":false,"data":"","available":["object","string","number","Date","boolean"],"error":false},"required":false,"ref":false,"metadata":{"index":0,"displayname":"value a"},"flags":"d"},"DXtW9KbD3R":{"id":"DXtW9KbD3R","group":null,"key":"operator","value":{"type":"string","collection":false,"data":"=="},"required":false,"ref":false,"metadata":{"index":1,"choices":[{"value":"==","label":"equal to"},{"value":"!=","label":"not equal"},{"value":">=","label":"greater than or equal"},{"value":"<=","label":"less than or equal"},{"value":">","label":"greater than"},{"value":"<","label":"less than"},{"value":"%","label":"a multiple of"},{"value":"in","label":"in"},{"value":"not in","label":"not in"},{"value":"has","label":"has key"},{"value":"doesn't have","label":"doesn't have key"},{"value":"is empty","label":"is empty"},{"value":"is not empty","label":"is not empty"}],"displayname":"comparison"},"flags":"d"},"952u5aFPTW":{"id":"952u5aFPTW","group":null,"key":"right-operand","value":{"type":"string","collection":false,"data":"finished","available":["object","string","number","Date","boolean"],"error":false},"required":false,"ref":false,"metadata":{"index":2,"displayname":"value b"},"flags":"d"},"_IZaJegfae":{"id":"_IZaJegfae","group":"otherwise","key":"message","value":{"type":"string","collection":false,"data":null,"available":["*"]},"required":false,"ref":false,"metadata":{"index":3},"flags":"d"}}},"outputs":{"extensible":false,"data":{"4XVQIospur":{"id":"4XVQIospur","group":null,"key":"message","value":{"type":"string","collection":false,"data":null},"ref":false,"metadata":{"hidden":true,"displayed":false,"index":0}}}},"runtime":{},"comments":"We only continue if the run has finished."}},"pins":{}},{"joins":{},"address":"root:kernel:control:0.0.1:continueIf","parents":{"version":{"address":"root:kernel:control:0.0.1","key":"0.0.1","data":{"name":"0.0.1"}},"channel":{"address":"root:kernel:control","key":"control","data":{"name":"control"}}},"uuid":"P1op3Y6yj","branches":{},"node":{"key":"continueIf","data":{"name":"Continue If (Has-Changes == true\")"},"model":{"type":"method","_v":2,"key":"continueIf","executable":false,"displayed":true,"async":false,"cooperative":false,"mirrored":false,"inlined":false,"dependencies":[],"timeout":90000,"idempotent":false,"monitor":false,"webhook":false,"webhookList":false,"webhookConditions":false,"mobile":false,"hooks":{},"policy":{"error":{"type":"finish"}},"metadata":{"id":null,"name":"Continue If (Has-Changes == true\")","description":"Stop the Flow if a condition isn't true."},"meta":{},"config":null,"partnerChannelKeys":null,"inputs":{"extensible":false,"rules":{"left-operand":{"types":["object","string","number","Date","boolean"]},"right-operand":{"types":["object","string","number","Date","boolean"]}},"data":{"iOOjsHG2r5":{"id":"iOOjsHG2r5","group":null,"key":"left-operand","value":{"type":"boolean","collection":false,"data":false,"available":["object","string","number","Date","boolean"],"error":false},"required":false,"ref":false,"metadata":{"index":0,"displayname":"value a"},"flags":"d"},"9A8ce1ePzv":{"id":"9A8ce1ePzv","group":null,"key":"operator","value":{"type":"string","collection":false,"data":"=="},"required":false,"ref":false,"metadata":{"index":1,"choices":[{"value":"==","label":"equal to"},{"value":"!=","label":"not equal"},{"value":">=","label":"greater than or equal"},{"value":"<=","label":"less than or equal"},{"value":">","label":"greater than"},{"value":"<","label":"less than"},{"value":"%","label":"a multiple of"},{"value":"in","label":"in"},{"value":"not in","label":"not in"},{"value":"has","label":"has key"},{"value":"doesn't have","label":"doesn't have key"},{"value":"is empty","label":"is empty"},{"value":"is not empty","label":"is not empty"}],"displayname":"comparison"},"flags":"d"},"xgbkuUNfP4":{"id":"xgbkuUNfP4","group":null,"key":"right-operand","value":{"type":"string","collection":false,"data":"true","available":["object","string","number","Date","boolean"],"error":false},"required":false,"ref":false,"metadata":{"index":2,"displayname":"value b"},"flags":"d"},"flUupIeFEG":{"id":"flUupIeFEG","group":"otherwise","key":"message","value":{"type":"string","collection":false,"data":null,"available":["*"]},"required":false,"ref":false,"metadata":{"index":3},"flags":"d"}}},"outputs":{"extensible":false,"data":{"WsSK7F8Vkd":{"id":"WsSK7F8Vkd","group":null,"key":"message","value":{"type":"string","collection":false,"data":null},"ref":false,"metadata":{"hidden":true,"displayed":false,"index":0}}}},"runtime":{},"comments":"We only want to continue if the completed run has detected changes - this indicates drift."}},"pins":{}},{"joins":{},"address":"root:kernel:string:0.0.1:compose","parents":{"version":{"address":"root:kernel:string:0.0.1","key":"0.0.1","data":{"name":"0.0.1"}},"channel":{"address":"root:kernel:string","key":"string","data":{"name":"string"}}},"uuid":"AqQrA4REO","branches":{},"node":{"key":"compose","data":{"name":"Compose Drift Notification"},"model":{"type":"method","_v":2,"key":"compose","executable":false,"displayed":true,"async":false,"cooperative":false,"mirrored":false,"inlined":false,"dependencies":[],"timeout":90000,"idempotent":false,"monitor":false,"webhook":false,"webhookList":false,"webhookConditions":false,"mobile":false,"hooks":{},"policy":{"error":{"type":"finish"}},"metadata":{"id":null,"name":"Compose Drift Notification","description":"Enter free form text and optionally drag fields into your text like a mail merge."},"meta":{},"config":null,"partnerChannelKeys":null,"inputs":{"extensible":true,"rules":{"*":{"types":["string"],"collection":false}},"data":{"3-r4MBgjfS":{"id":"3-r4MBgjfS","group":null,"key":"_text_","value":{"type":"string","collection":false,"data":"Terraform Plan \"{{{TiBKc6fUz}}}\" has detected changes which may indicate drift in the Okta production environment.  Please review the logs and take appropriate action.\n\nLog: {{{b9285mxD5}}}","available":[],"error":false},"required":true,"ref":false,"metadata":{"index":0},"flags":"d"},"5eOAUPmm4V":{"id":"5eOAUPmm4V","group":null,"key":"TiBKc6fUz","value":{"error":false,"proxy":false,"check":false,"type":"string","collection":false,"data":"","available":["string"]},"required":false,"ref":false,"metadata":{"index":1},"flags":"d"},"uUIm00r0bQ":{"id":"uUIm00r0bQ","group":null,"key":"b9285mxD5","value":{"error":false,"proxy":false,"check":false,"type":"string","collection":false,"data":"","available":["string"]},"required":false,"ref":false,"metadata":{"index":2},"flags":"d"}}},"outputs":{"extensible":false,"data":{"Q_DKjwsaa-":{"id":"Q_DKjwsaa-","group":null,"key":"output","value":{"type":"string","collection":false,"data":""},"ref":false,"metadata":{"index":0},"_used":true}}},"runtime":{},"comments":"Compose the message to be sent to the Slack channel.\n\nIncludes the message of the run and a link to the log detailing specifics."}},"pins":{"Q_DKjwsaa-":{"UTanxRUWp":[{"input":"lZ1IwsKsG","transform":null}]}}},{"joins":{},"address":"root:kernel:string:0.0.1:compose","parents":{"version":{"address":"root:kernel:string:0.0.1","key":"0.0.1","data":{"name":"0.0.1"}},"channel":{"address":"root:kernel:string","key":"string","data":{"name":"string"}}},"uuid":"sG7PSk-Aj","branches":{},"node":{"key":"compose","data":{"name":"Compose Post Body"},"model":{"type":"method","_v":2,"key":"compose","executable":false,"displayed":true,"async":false,"cooperative":false,"mirrored":false,"inlined":false,"dependencies":[],"timeout":90000,"idempotent":false,"monitor":false,"webhook":false,"webhookList":false,"webhookConditions":false,"mobile":false,"hooks":{},"policy":{"error":{"type":"finish","delay":[60000,180000],"retry":0,"retryCondition":"ratelimits"}},"metadata":{"id":null,"name":"Compose Post Body","description":"Enter free form text and optionally drag fields into your text like a mail merge."},"meta":{},"config":null,"partnerChannelKeys":null,"inputs":{"extensible":true,"rules":{"*":{"types":["string"],"collection":false}},"data":{"MlbglBF6em":{"id":"MlbglBF6em","group":null,"key":"_text_","value":{"type":"string","collection":false,"data":"{\n \"data\": {\n \"attributes\": {\n \"message\": \"Daily run to detect drift\",\n \"auto-apply\": false,\n \"plan-only\": true\n },\n \"type\": \"runs\",\n \"relationships\": {\n \"workspace\": {\n \"data\": {\n \"type\": \"workspaces\",\n \"id\": \"ws-5DWf82maYKxBrvaE\"\n }\n }\n }\n }\n}","available":[],"error":false},"required":true,"ref":false,"metadata":{"index":0},"flags":"d"}}},"outputs":{"extensible":false,"data":{"DeEof_IgUA":{"id":"DeEof_IgUA","group":null,"key":"output","value":{"type":"string","collection":false,"data":""},"ref":false,"metadata":{"index":0},"_used":true}}},"runtime":{},"comments":"Compose post body - identify the workspace ID to execute for.  Set auto-apply to false so that changes are not automatically applied (we don't want that!)"}},"pins":{"DeEof_IgUA":{"JszvgLOn4":[{"input":"e6WnWGiUj4","transform":null}]}}},{"joins":{},"address":"root:channels:http:slack:1.6.229:sendMessageToChannel2","parents":{"version":{"address":"root:channels:http:slack:1.6.229","key":"1.6.229","data":{"name":"1.6.229","id":941}},"channel":{"address":"root:channels:http:slack","key":"slack","data":{"name":"slack","id":24}}},"uuid":"UTanxRUWp","branches":{},"node":{"key":"sendMessageToChannel2","data":{"name":"Send Message to Channel"},"model":{"type":"method","_v":2,"key":"sendMessageToChannel2","executable":true,"displayed":true,"async":true,"cooperative":false,"mirrored":false,"compat":false,"inlined":false,"dependencies":[],"timeout":30000,"idempotent":false,"monitor":false,"webhook":false,"webhookList":false,"webhookConditions":false,"mobile":false,"hooks":{},"policy":{"error":{"type":"finish"}},"metadata":{"id":37550,"name":"Send Message to Channel","description":null},"meta":{"b7faef44-61ec-4beb-b759-b3830d0ddc60":{"id":"CW2EQKmKjt","address":{"key":null,"group":null,"groupIndex":0,"defaultValue":{"method":"makeChannelOrNameInput"},"namespace":"input"}},"a201f7f8-e89d-4a71-97c4-a923bf2240ac":{"id":"5DU5vV0EwM","address":{"key":null,"group":null,"groupIndex":1,"defaultValue":{"method":"sendMessageInputs"},"namespace":"input"}},"4a0e3fdd-1a92-4645-b743-0c971d0441a1":{"id":"SwiUH9YPb1","address":{"key":null,"group":null,"groupIndex":2,"defaultValue":{"method":"slackbotNameInput"},"namespace":"input"}}},"config":"7c69589d-af14-4a61-93a0-360787bc7ebf","partnerChannelKeys":208,"inputs":{"extensible":false,"rules":{},"groupRules":{"Message":{"index":1},"Slackbot":{"index":2}},"data":{"bNqJM9A4Mx":{"id":"bNqJM9A4Mx","group":"parameters","key":"channel","value":{"error":false,"proxy":false,"check":false,"type":"string","collection":false,"data":"C0398LCMUG5","available":[]},"required":false,"ref":false,"metadata":{"type":"dynamic","method":{"channel":"slack","operation":"createChannelDropdown","key":"name","value":"id"},"displayname":"Channel","optional":false,"ordering":0,"index":0},"flags":"p"},"iZftFtx_Uu":{"id":"iZftFtx_Uu","group":"parameters","key":"bot","value":{"error":false,"proxy":false,"check":false,"type":"string","collection":false,"data":"Yes","available":[]},"required":false,"ref":false,"metadata":{"type":"list","displayname":"Send as bot?","choices":[{"label":"Yes","value":"Yes"},{"label":"No","value":"No"}],"dependencies":[],"optional":false,"ordering":1,"index":1},"flags":"p"},"rqovbSv-sF":{"id":"rqovbSv-sF","group":"parameters","key":"links","value":{"error":false,"proxy":false,"check":false,"type":"string","collection":false,"data":"Yes","available":[]},"required":false,"ref":false,"metadata":{"type":"list","displayname":"Unfurl URLs?","choices":[{"label":"Yes","value":"Yes"},{"label":"No","value":"No"}],"dependencies":[],"optional":false,"ordering":2,"index":2},"flags":"p"},"DX_L0b1Z_Q":{"id":"DX_L0b1Z_Q","group":"parameters","key":"messageType","value":{"error":false,"proxy":false,"check":false,"type":"string","collection":false,"data":"Plain Text","available":[]},"required":false,"ref":false,"metadata":{"type":"list","displayname":"Message Type","choices":[{"label":"Plain Text","value":"Plain Text"},{"label":"Blocks","value":"Blocks"}],"dependencies":[],"optional":false,"ordering":3,"index":3},"flags":"p"},"lZ1IwsKsG":{"id":"lZ1IwsKsG","group":"Message","key":"Text","value":{"error":false,"proxy":false,"check":false,"type":"string","collection":false,"data":"","available":["string"]},"required":true,"ref":false,"metadata":{"index":0,"optional":false},"flags":"d"},"DecCs6-Zp7":{"id":"DecCs6-Zp7","group":"Slackbot","key":"Name","value":{"error":false,"proxy":false,"check":false,"type":"string","collection":false,"data":"Terraform-drift-bot","available":["string"]},"required":false,"ref":false,"metadata":{"index":0,"optional":false},"flags":"d"}}},"outputs":{"extensible":false,"rules":{},"groupRules":{"Message":{"extensible":false,"reserved":{},"index":0,"type":"object"}},"data":{"GbbMEkW-Zf":{"id":"GbbMEkW-Zf","group":"Message","key":"Timestamp","value":{"error":false,"type":"string","collection":false,"data":"","available":["string"]},"ref":false,"metadata":{"index":0}}}},"runtime":{},"display":{},"comments":"Send a message to a public or private channel as a user or bot in Slack.\n\nSends the notification (via bot) that drift has been detected in the Terraform plan run that needs attention.","enableNewMetadata":true}},"pins":{}},{"joins":{},"address":"root:kernel:object:0.0.1:expand","parents":{"version":{"address":"root:kernel:object:0.0.1","key":"0.0.1","data":{"name":"0.0.1"}},"channel":{"address":"root:kernel:object","key":"object","data":{"name":"object"}}},"uuid":"GlNibMMJuZ","branches":{},"node":{"key":"expand","data":{"name":"JszvgLOn4"},"model":{"type":"method","_v":2,"key":"expand","executable":false,"displayed":false,"async":false,"cooperative":false,"mirrored":false,"inlined":false,"dependencies":[],"timeout":30000,"idempotent":false,"monitor":false,"webhook":false,"webhookList":false,"webhookConditions":false,"mobile":false,"hooks":{},"policy":{"error":{"type":"finish"}},"metadata":{"id":null,"name":"JszvgLOn4","description":"Pick a set of keys out of an object with lists of keys."},"meta":{},"config":null,"partnerChannelKeys":null,"inputs":{"extensible":false,"data":{"SPW4DXlCh-":{"id":"SPW4DXlCh-","group":null,"key":"object","value":{"type":{"data":{"type":{"id":{"type":"string","collection":false},"relationships":{"type":{"plan":{"type":{"links":{"type":{"related":{"type":"string","collection":false}},"collection":false}},"collection":false}},"collection":false},"attributes":{"type":{"message":{"type":"string","collection":false}},"collection":false}},"collection":false}},"collection":false,"data":{},"available":[],"error":false},"required":true,"ref":false,"metadata":{"srcMethodId":"JszvgLOn4","srcOutputId":"IkbAPIy_0H"},"flags":"d"}}},"outputs":{"extensible":true,"groupRules":{"*":{"type":"object","reserved":{"key":{"types":["string"],"collection":"*"},"value":{"types":["*"],"collection":"*"}},"extensible":false}},"data":{"MSMeMzq1hV":{"id":"MSMeMzq1hV","group":"EldKBChbvX","key":"key","value":{"error":false,"type":"string","collection":true,"data":["data","relationships","plan","links","related"],"available":[]},"ref":true,"metadata":{"path":["data","relationships","plan","links","related"],"srcMethodId":"JszvgLOn4","srcOutputId":"IkbAPIy_0H"}},"gwxysdJBEH":{"id":"gwxysdJBEH","group":"EldKBChbvX","key":"value","value":{"error":false,"type":"string","collection":false,"data":null,"available":[]},"ref":false,"metadata":{"path":["data","relationships","plan","links","related"],"srcMethodId":"JszvgLOn4","srcOutputId":"IkbAPIy_0H"},"_used":true},"MvznIR9yzFk":{"id":"MvznIR9yzFk","group":"9kxvbWlEcns","key":"key","value":{"error":false,"type":"string","collection":true,"data":["data","attributes","message"],"available":[]},"ref":true,"metadata":{"path":["data","attributes","message"],"srcMethodId":"JszvgLOn4","srcOutputId":"IkbAPIy_0H"}},"lR7twFAtyKJ":{"id":"lR7twFAtyKJ","group":"9kxvbWlEcns","key":"value","value":{"error":false,"type":"string","collection":false,"data":null,"available":[]},"ref":false,"metadata":{"path":["data","attributes","message"],"srcMethodId":"JszvgLOn4","srcOutputId":"IkbAPIy_0H"},"_used":true}}},"runtime":{}}},"pins":{"gwxysdJBEH":{"LjnFRNrnO":[{"input":"P58KwM6hiP","transform":null}]},"lR7twFAtyKJ":{"AqQrA4REO":[{"input":"5eOAUPmm4V","transform":null}]}}},{"joins":{},"address":"root:kernel:object:0.0.1:expand","parents":{"version":{"address":"root:kernel:object:0.0.1","key":"0.0.1","data":{"name":"0.0.1"}},"channel":{"address":"root:kernel:object","key":"object","data":{"name":"object"}}},"uuid":"55gNUjSa9R2","branches":{},"node":{"key":"expand","data":{"name":"_G_4uwI21"},"model":{"type":"method","_v":2,"key":"expand","executable":false,"displayed":false,"async":false,"cooperative":false,"mirrored":false,"inlined":false,"dependencies":[],"timeout":30000,"idempotent":false,"monitor":false,"webhook":false,"webhookList":false,"webhookConditions":false,"mobile":false,"hooks":{},"policy":{"error":{"type":"finish"}},"metadata":{"id":null,"name":"_G_4uwI21","description":"Pick a set of keys out of an object with lists of keys."},"meta":{},"config":null,"partnerChannelKeys":null,"inputs":{"extensible":false,"data":{"_4fqLTGp8_c":{"id":"_4fqLTGp8_c","group":null,"key":"object","value":{"type":{"data":{"type":{"attributes":{"type":{"status":{"type":"string","collection":false},"has-changes":{"type":"boolean","collection":false},"log-read-url":{"type":"string","collection":false}},"collection":false}},"collection":false}},"collection":false,"data":{},"available":[],"error":false},"required":true,"ref":false,"metadata":{"srcMethodId":"_G_4uwI21","srcOutputId":"8ZIE0APaU8"},"flags":"d"}}},"outputs":{"extensible":true,"groupRules":{"*":{"type":"object","reserved":{"key":{"types":["string"],"collection":"*"},"value":{"types":["*"],"collection":"*"}},"extensible":false}},"data":{"3A5isZbZ7Y6":{"id":"3A5isZbZ7Y6","group":"8lh1IctBwX7","key":"key","value":{"error":false,"type":"string","collection":true,"data":["data","attributes","status"],"available":[]},"ref":true,"metadata":{"path":["data","attributes","status"],"srcMethodId":"_G_4uwI21","srcOutputId":"8ZIE0APaU8"}},"Pxgu-4SHecG":{"id":"Pxgu-4SHecG","group":"8lh1IctBwX7","key":"value","value":{"error":false,"type":"string","collection":false,"data":null,"available":[]},"ref":false,"metadata":{"path":["data","attributes","status"],"srcMethodId":"_G_4uwI21","srcOutputId":"8ZIE0APaU8"},"_used":true},"DMW0sSRKvdM":{"id":"DMW0sSRKvdM","group":"GESo3_3mR9y","key":"key","value":{"error":false,"type":"string","collection":true,"data":["data","attributes","has-changes"],"available":[]},"ref":true,"metadata":{"path":["data","attributes","has-changes"],"srcMethodId":"_G_4uwI21","srcOutputId":"8ZIE0APaU8"}},"Ge9iuFyJZAP":{"id":"Ge9iuFyJZAP","group":"GESo3_3mR9y","key":"value","value":{"error":false,"type":"boolean","collection":false,"data":null,"available":[]},"ref":false,"metadata":{"path":["data","attributes","has-changes"],"srcMethodId":"_G_4uwI21","srcOutputId":"8ZIE0APaU8"},"_used":true},"Xfam2cKjt5E":{"id":"Xfam2cKjt5E","group":"xCnwLPiUaPV","key":"key","value":{"error":false,"type":"string","collection":true,"data":["data","attributes","log-read-url"],"available":[]},"ref":true,"metadata":{"path":["data","attributes","log-read-url"],"srcMethodId":"_G_4uwI21","srcOutputId":"8ZIE0APaU8"}},"z9B6RSfr5EW":{"id":"z9B6RSfr5EW","group":"xCnwLPiUaPV","key":"value","value":{"error":false,"type":"string","collection":false,"data":null,"available":[]},"ref":false,"metadata":{"path":["data","attributes","log-read-url"],"srcMethodId":"_G_4uwI21","srcOutputId":"8ZIE0APaU8"},"_used":true}}},"runtime":{}}},"pins":{"Pxgu-4SHecG":{"NtXJexVD6":[{"input":"mABEYgvDHd","transform":null}]},"Ge9iuFyJZAP":{"P1op3Y6yj":[{"input":"iOOjsHG2r5","transform":null}]},"z9B6RSfr5EW":{"AqQrA4REO":[{"input":"uUIm00r0bQ","transform":null}]}}}],"model":{},"orderings":{"yiI1JADRb":["skB2fHeGQ","sG7PSk-Aj"],"T68zsxYbzm":["sG7PSk-Aj","JszvgLOn4"],"a1zLaN49Y3":["JszvgLOn4","Uz2TRfdlA"],"8US8MQADvB":["Uz2TRfdlA","MXHReK3Fe"],"s21KTEoGjl":["MXHReK3Fe","LjnFRNrnO"],"ZZiQJTiSz4":["LjnFRNrnO","_G_4uwI21"],"urUti0oRe-":["_G_4uwI21","NtXJexVD6"],"WU5jDj1Wy1":["NtXJexVD6","P1op3Y6yj"],"nS8MkKG9uA":["P1op3Y6yj","AqQrA4REO"],"QoG8Eb5Mnc":["AqQrA4REO","UTanxRUWp"],"5ne7_36rQJ":["JszvgLOn4","GlNibMMJuZ"],"E7pb_IuHMHQ":["GlNibMMJuZ","Uz2TRfdlA"],"QPjsSqjPv6N":["GlNibMMJuZ","GlNibMMJuZ"],"TsQVkplQQuR":["GlNibMMJuZ","Uz2TRfdlA"],"Z394lWApKQ5":["GlNibMMJuZ","GlNibMMJuZ"],"PDsH4Z0_MT-":["_G_4uwI21","55gNUjSa9R2"],"nbDGXq5_pbp":["55gNUjSa9R2","NtXJexVD6"],"zdLuM2jzkj4":["55gNUjSa9R2","55gNUjSa9R2"],"wLlu8xBb806":["55gNUjSa9R2","NtXJexVD6"],"7zIYFI45NKZ":["55gNUjSa9R2","55gNUjSa9R2"],"ASWcZp58-Hq":["55gNUjSa9R2","NtXJexVD6"],"2TeVf3wniO2":["55gNUjSa9R2","55gNUjSa9R2"]},"cron":{"seconds":"00","minutes":"0","hours":"9","dayOfTheMonth":"*/1","month":"*","dayOfTheWeek":"*","startDate":"","endDate":"","recurrence":0,"timeZone":"America/New_York"},"security_level":null,"log":true,"inheritLog":true,"scheduled":true,"group":"68a203f8-975d-422a-94a6-000fd2d858d6","templateName":null,"connector_method_meta":{"inputs":{},"outputs":{},"options":{}},"monitor_flo":false}}},"configs":{"2756f226-1bc4-4e93-8ab2-957e510fd377":{"id":"2756f226-1bc4-4e93-8ab2-957e510fd377","name":"Terraform Cloud","module":"httpfunctions","data":null},"7c69589d-af14-4a61-93a0-360787bc7ebf":{"id":"7c69589d-af14-4a61-93a0-360787bc7ebf","name":"Slack Demo Env","module":"slack","data":null}},"tables":{},"groups":{"68a203f8-975d-422a-94a6-000fd2d858d6":{"id":"68a203f8-975d-422a-94a6-000fd2d858d6","data":{"name":"Okta Configuration Drift","description":"","media_uri":""}}}},"checksum":"1566eefdb490354fa9efd248ba280bd43d2f21220289f18d71ea384f52854c8a"}